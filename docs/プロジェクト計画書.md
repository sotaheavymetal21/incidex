# incidex プロジェクト計画書

## 1. プロジェクト概要

### 1.1 プロジェクト名
**incidex**（インシデックス）
- incident + index/dex の造語
- インシデントをインデックス化し、組織の知見として蓄積する

### 1.2 目的
組織内で発生したインシデントを記録・管理し、AI要約とポストモーテムを通じて継続的な改善を促進するオープンソースのインシデント管理システムを構築する。

### 1.3 背景・解決すべき課題

#### 現状の問題点
1. **記録の分散と消失**
   - インシデント情報がPowerPoint、Excel、メール等に散在
   - 半期に一度の報告時しか見返さない
   - 過去の情報が検索できず、活用されない

2. **振り返りの形骸化**
   - PowerPoint作成の手間が大きく、負担になっている
   - 詳細な記録が残らず、根本原因分析が不十分
   - 類似インシデントが再発しても、過去の知見を活かせない

3. **情報の可視化不足**
   - インシデントの傾向や統計が見えない
   - どのカテゴリで問題が多いかわからない
   - MTTRなどの指標が計測できない

4. **既存ツールの課題**
   - 商用ツール（PagerDuty、Opsgenie等）は月額数千円〜と高価
   - 既存OSSはアラート管理中心で、ポストモーテムとデータ蓄積が弱い
   - セキュリティ上、外部SaaSにデータを出せない組織も多い

#### あるべき姿
- インシデント発生時に即座に記録でき、タイムライン形式で経緯を管理
- AIによる自動要約で、長文の詳細から素早く概要を把握
- 過去のインシデントを検索・参照し、類似事例から学べる
- ポストモーテムを通じて根本原因を分析し、再発防止策を明確化
- 統計情報から組織のインシデント傾向を可視化
- PDF形式で半期レポートを自動生成し、報告の手間を削減
- 無料でセルフホスト可能、データは組織内に保持

### 1.4 ターゲットユーザー
- 中小規模の開発チーム・SREチーム（5-50名）
- セキュリティオペレーションチーム（SOC）
- IT部門・情報システム部門
- コスト重視でセルフホスティングを希望する組織
- データを外部SaaSに出したくない組織（金融機関、官公庁等）

### 1.5 プロジェクトの差別化ポイント
1. **AI要約機能**: 長文詳細から自動で概要生成、素早い情報把握
2. **ポストモーテム重視**: アラート管理ではなく、事後分析・学習・知識蓄積に特化
3. **完全無料**: オープンソース、利用制限なし
4. **セルフホスタブル**: Docker Composeで簡単セットアップ、データは組織内管理
5. **PDF自動生成**: 半期レポート作成の手間を削減
6. **高速検索**: PostgreSQL全文検索 + Redisキャッシュ

---

## 2. スコープ定義

### 2.1 含まれる機能（In Scope）

#### Phase 1: MVP（最小機能製品）
**目標**: インシデントの記録・管理・閲覧ができる基本システム

**認証・ユーザー管理**
- ユーザー登録・ログイン機能
- JWT認証
- 役割管理（管理者、編集者、閲覧者）

**インシデント管理**
- インシデントの作成・編集・削除・一覧表示
- 以下の情報を管理:
  - タイトル（必須）
  - 詳細説明（必須）
  - 深刻度（Critical / High / Medium / Low）
  - ステータス（Open / Investigating / Resolved / Closed）
  - 影響範囲
  - 検知日時
  - 解決日時
  - 担当者・作成者
- ページネーション機能
- 基本的な検索機能（タイトル・説明での部分一致検索）

**AI要約機能**
- インシデント詳細から自動で概要を生成
- Claude API または OpenAI API を使用
- 要約の再生成機能
- エラー時のフォールバック

**タイムライン機能**
- インシデントに紐づく時系列イベントの記録
- イベントタイプ（検知、調査開始、原因特定、緩和、解決等）
- イベント時刻、説明、記録者
- イベントの追加・編集・削除

**タグ管理**
- タグの作成・編集・削除
- インシデントへのタグ付け（複数可）
- カラー設定
- タグでのフィルタリング

**ダッシュボード**
- インシデント件数推移（日別・週別・月別）
- 深刻度別の分布（円グラフ）
- ステータス別の分布
- 最近のインシデント一覧（直近10件）

#### Phase 2: 機能拡張
**目標**: ポストモーテムと高度な分析機能の実装

**ポストモーテム機能**
- インシデントに対するポストモーテムの作成・編集
- 以下の情報を管理:
  - 根本原因分析（Five Whysテンプレート）
  - 対応の良かった点
  - 改善が必要だった点
  - 再発防止策
  - アクションアイテム（担当者、期限）
- AI支援による根本原因分析の提案

**高度な検索・フィルタリング**
- PostgreSQL全文検索（日本語・英語対応）
- 複数条件での絞り込み:
  - 深刻度
  - ステータス
  - タグ
  - 日付範囲
  - 担当者
  - 作成者
- 検索結果のRedisキャッシュによる高速化
- 検索履歴の保存

**統計・分析ダッシュボード**
- MTTR（平均復旧時間）の計算・表示
- カテゴリ別のインシデント傾向分析
- 再発率のトラッキング
- 月次・四半期レポート
- グラフのカスタマイズ機能

**通知機能（オプション）**
- 新規インシデント作成時の通知
- ステータス変更時の通知
- アクションアイテム期限のリマインダー

#### Phase 3: 完成機能
**目標**: レポート生成とファイル管理の実装

**PDF自動生成**
- 単体インシデントのPDFレポート出力
- 期間指定でのサマリーレポート生成
- 以下を含むレポート:
  - インシデント一覧
  - 統計グラフ
  - 傾向分析
  - ポストモーテムサマリー
- レポートテンプレートのカスタマイズ機能

**ファイル添付機能**
- インシデントへのファイル添付（ログ、スクリーンショット等）
- MinIOによるオブジェクトストレージ管理
- ファイルのプレビュー機能
- ファイルサイズ制限（1ファイル最大50MB、合計500MB）

**外部連携（オプション）**
- Webhook通知
- Slack連携（インシデント作成・更新通知）
- APIキー管理機能

### 2.2 含まれない機能（Out of Scope）

以下の機能は本プロジェクトの対象外とする:

**アラート管理・監視ツール連携**
- リアルタイムアラートの受信・管理
- 監視ツール（Prometheus、Datadog等）との自動連携
- アラートルールの設定
→ 理由: 既存の監視ツールと組み合わせて使用することを想定

**オンコール管理**
- オンコールスケジュールの作成・管理
- オンコールローテーション
- エスカレーションポリシー
→ 理由: PagerDuty等の専門ツールの領域

**リアルタイムコミュニケーション**
- チャット機能
- ビデオ会議統合
- リアルタイム共同編集
→ 理由: Slack等の既存ツールで代替可能

**複雑なワークフロー機能**
- 承認フロー
- 複雑なステータス遷移ルール
- 自動アサイン機能
→ 理由: シンプルさを優先

**モバイルアプリ**
- iOS/Androidネイティブアプリ
→ 理由: レスポンシブWebで対応

**SaaS版の提供**
- マネージドホスティング
- マルチテナント機能
→ 理由: セルフホスト型に特化

### 2.3 将来的な拡張候補（Future Scope）

以下は現時点では対象外だが、将来的に検討可能な機能:

- 多言語UI対応（日本語・英語以外）
- インシデント間の関連付け機能
- カスタムフィールド定義機能
- APIのGraphQL対応
- Kubernetes Operator
- 機械学習による異常検知・予測
- 外部監視ツールとのネイティブ統合

---

## 3. 技術スタック

**フロントエンド**: Next.js 14+, TypeScript, React, TailwindCSS, Material UI

**バックエンド**: Go 1.21+, Gin, GORM, JWT

**データベース・ストレージ**: PostgreSQL 15+, Redis 7+, MinIO

**Webサーバー**: Nginx

**その他**: Docker Compose, Atlas（マイグレーション）, Claude/OpenAI API

---

## 4. スケジュール

| フェーズ | 期間 | 主要成果物 |
|---------|------|-----------|
| Phase 0: 準備 | 1週間 | Docker環境、リポジトリ、雛形 |
| Phase 1: MVP | 4-5週間 | 基本機能完動 |
| Phase 2: 拡張 | 3-4週間 | ポストモーテム、検索、分析 |
| Phase 3: 完成 | 2-3週間 | PDF生成、ファイル添付 |
| Phase 4: 公開準備 | 1-2週間 | ドキュメント、デプロイ手順 |

**合計**: 約3-4ヶ月

---



## 6. リスク管理

| リスク | 影響 | 発生確率 | 対策 |
|--------|------|---------|------|
| スコープクリープ | 高 | 中 | Phase分割で管理、MVP最優先 |
| AI APIコスト | 中 | 中 | キャッシュ活用、使用量監視 |
| 時間不足 | 中 | 中 | Phase 1のみでもリリース可能に |
| セキュリティ脆弱性 | 高 | 低 | 基本対策徹底、依存更新 |

---

## 7. 次のアクション（Phase 0）

1. GitHubリポジトリ作成（`incidex`）
2. Docker Compose環境構築
3. バックエンド雛形（Hello World API）
4. フロントエンド雛形
5. 各サービス疎通確認
